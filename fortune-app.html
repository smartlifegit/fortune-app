<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ğŸ”® ì˜¤ëŠ˜ì˜ ìš´ì„¸ ë½‘ê¸°</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0f0c29">
<link rel="manifest" href="manifest.json">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&family=Black+Han+Sans&display=swap" rel="stylesheet">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg-start: #0f0c29;
    --bg-mid: #302b63;
    --bg-end: #24243e;
    --gold: #ffd700;
    --gold-dim: #b8960c;
    --card-bg: rgba(255, 255, 255, 0.06);
    --text: #f0e6ff;
  }

  body {
    font-family: 'Noto Sans KR', sans-serif;
    background: linear-gradient(135deg, var(--bg-start), var(--bg-mid), var(--bg-end));
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: var(--text);
    overflow: hidden;
    padding: 20px;
  }

  /* Floating stars background */
  .stars {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    z-index: 0;
  }
  .star {
    position: absolute;
    width: 3px; height: 3px;
    background: white;
    border-radius: 50%;
    animation: twinkle var(--dur) ease-in-out infinite alternate;
    opacity: 0;
  }
  @keyframes twinkle {
    0% { opacity: 0.1; transform: scale(0.8); }
    100% { opacity: 0.9; transform: scale(1.3); }
  }

  .app-container {
    position: relative;
    z-index: 1;
    text-align: center;
    max-width: 400px;
    width: 100%;
  }

  .title {
    font-family: 'Black Han Sans', sans-serif;
    font-size: 2.4rem;
    color: var(--gold);
    text-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
    margin-bottom: 8px;
    animation: floatTitle 3s ease-in-out infinite;
  }
  @keyframes floatTitle {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
  }

  .subtitle {
    font-size: 0.95rem;
    color: rgba(240, 230, 255, 0.6);
    margin-bottom: 36px;
    letter-spacing: 2px;
  }

  /* Fortune card */
  .fortune-card {
    background: var(--card-bg);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 215, 0, 0.15);
    border-radius: 24px;
    padding: 32px 24px;
    margin-bottom: 32px;
    min-height: 220px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }
  .fortune-card::before {
    content: '';
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background: conic-gradient(from 0deg, transparent, rgba(255, 215, 0, 0.05), transparent, rgba(255, 215, 0, 0.03), transparent);
    animation: shimmer 8s linear infinite;
  }
  @keyframes shimmer { 100% { transform: rotate(360deg); } }

  .fortune-card.reveal {
    border-color: rgba(255, 215, 0, 0.4);
    box-shadow: 0 0 60px rgba(255, 215, 0, 0.15);
  }

  .fortune-emoji {
    font-size: 4rem;
    margin-bottom: 16px;
    position: relative;
    z-index: 1;
  }
  .fortune-emoji.spin {
    animation: spinEmoji 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }
  @keyframes spinEmoji {
    0% { transform: rotateY(0) scale(0.5); opacity: 0; }
    50% { transform: rotateY(180deg) scale(1.3); }
    100% { transform: rotateY(360deg) scale(1); opacity: 1; }
  }

  .fortune-category {
    font-family: 'Black Han Sans', sans-serif;
    font-size: 1.5rem;
    color: var(--gold);
    margin-bottom: 12px;
    position: relative;
    z-index: 1;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.4s ease 0.2s;
  }
  .reveal .fortune-category {
    opacity: 1;
    transform: translateY(0);
  }

  .fortune-text {
    font-size: 1.05rem;
    line-height: 1.7;
    color: var(--text);
    position: relative;
    z-index: 1;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.4s ease 0.35s;
  }
  .reveal .fortune-text {
    opacity: 1;
    transform: translateY(0);
  }

  .fortune-score {
    margin-top: 16px;
    position: relative;
    z-index: 1;
    opacity: 0;
    transition: all 0.4s ease 0.5s;
  }
  .reveal .fortune-score {
    opacity: 1;
  }
  .score-bar {
    width: 200px;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
    margin: 8px auto 0;
  }
  .score-fill {
    height: 100%;
    border-radius: 4px;
    background: linear-gradient(90deg, #ff6b6b, var(--gold), #51cf66);
    width: 0%;
    transition: width 1s cubic-bezier(0.4, 0, 0.2, 1) 0.6s;
  }
  .score-label {
    font-size: 0.85rem;
    color: rgba(240, 230, 255, 0.5);
  }

  /* Placeholder state */
  .placeholder {
    position: relative;
    z-index: 1;
  }
  .placeholder-crystal {
    font-size: 5rem;
    animation: pulse 2s ease-in-out infinite;
  }
  @keyframes pulse {
    0%, 100% { transform: scale(1); filter: brightness(1); }
    50% { transform: scale(1.08); filter: brightness(1.3); }
  }
  .placeholder-text {
    font-size: 0.9rem;
    color: rgba(240, 230, 255, 0.4);
    margin-top: 16px;
  }

  /* Button */
  .fortune-btn {
    background: linear-gradient(135deg, var(--gold), #ffaa00);
    color: #1a1a2e;
    font-family: 'Black Han Sans', sans-serif;
    font-size: 1.3rem;
    border: none;
    border-radius: 60px;
    padding: 16px 48px;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 4px 25px rgba(255, 215, 0, 0.3);
    letter-spacing: 2px;
  }
  .fortune-btn:active {
    transform: scale(0.95);
  }
  .fortune-btn:hover {
    box-shadow: 0 6px 35px rgba(255, 215, 0, 0.5);
    transform: translateY(-2px);
  }
  .fortune-btn::after {
    content: '';
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background: linear-gradient(transparent, rgba(255,255,255,0.2), transparent);
    transform: rotate(45deg) translateX(-100%);
    transition: 0.6s;
  }
  .fortune-btn:hover::after {
    transform: rotate(45deg) translateX(100%);
  }

  .fortune-btn.loading {
    pointer-events: none;
    animation: shake 0.5s ease-in-out;
  }
  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-8px) rotate(-2deg); }
    40% { transform: translateX(8px) rotate(2deg); }
    60% { transform: translateX(-5px) rotate(-1deg); }
    80% { transform: translateX(5px) rotate(1deg); }
  }

  .count {
    margin-top: 24px;
    font-size: 0.8rem;
    color: rgba(240, 230, 255, 0.3);
  }

  /* Confetti burst */
  .confetti-container {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    z-index: 10;
  }
  .confetti {
    position: absolute;
    width: 8px; height: 8px;
    opacity: 0;
  }
  @keyframes confettiFall {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
  }

  /* ì¢…ë£Œ ë²„íŠ¼ */
  .close-btn {
    position: fixed;
    top: 16px;
    right: 16px;
    z-index: 100;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: 1.5px solid rgba(255, 215, 0, 0.3);
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(10px);
    color: var(--gold);
    font-size: 1.3rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }
  .close-btn:hover {
    background: rgba(255, 215, 0, 0.15);
    border-color: var(--gold);
    transform: scale(1.1);
  }
  .close-btn:active {
    transform: scale(0.95);
  }

  /* ì¢…ë£Œ í™•ì¸ ëª¨ë‹¬ */
  .modal-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(6px);
    z-index: 200;
    align-items: center;
    justify-content: center;
  }
  .modal-overlay.show {
    display: flex;
  }
  .modal-box {
    background: linear-gradient(135deg, #1e1b4b, #302b63);
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 20px;
    padding: 32px 28px;
    text-align: center;
    max-width: 300px;
    width: 85%;
    animation: modalIn 0.3s ease;
  }
  @keyframes modalIn {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }
  .modal-box p {
    font-size: 1.1rem;
    margin-bottom: 24px;
    color: var(--text);
    line-height: 1.6;
  }
  .modal-buttons {
    display: flex;
    gap: 12px;
    justify-content: center;
  }
  .modal-btn {
    padding: 10px 24px;
    border-radius: 30px;
    border: none;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 0.95rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .modal-btn:active { transform: scale(0.95); }
  .modal-btn.cancel {
    background: rgba(255, 255, 255, 0.1);
    color: var(--text);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  .modal-btn.cancel:hover { background: rgba(255, 255, 255, 0.2); }
  .modal-btn.confirm {
    background: linear-gradient(135deg, #ff6b6b, #ee5a24);
    color: white;
  }
  .modal-btn.confirm:hover { box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4); }
</style>
</head>
<body>

<!-- ì¢…ë£Œ ë²„íŠ¼ -->
<button class="close-btn" onclick="showExitModal()" title="ì¢…ë£Œ">âœ•</button>

<!-- ì¢…ë£Œ í™•ì¸ ëª¨ë‹¬ -->
<div class="modal-overlay" id="exitModal">
  <div class="modal-box">
    <p>ğŸ”® ì •ë§ ì¢…ë£Œí• ê¹Œìš”?</p>
    <div class="modal-buttons">
      <button class="modal-btn cancel" onclick="hideExitModal()">ì·¨ì†Œ</button>
      <button class="modal-btn confirm" onclick="exitApp()">ì¢…ë£Œ</button>
    </div>
  </div>
</div>

<!-- Stars -->
<div class="stars" id="stars"></div>

<!-- Confetti -->
<div class="confetti-container" id="confetti"></div>

<div class="app-container">
  <div class="title">ğŸ”® ì˜¤ëŠ˜ì˜ ìš´ì„¸</div>
  <div class="subtitle">ìˆ˜ì •êµ¬ìŠ¬ì„ í„°ì¹˜í•˜ì„¸ìš”</div>

  <div class="fortune-card" id="card">
    <div class="placeholder" id="placeholder">
      <div class="placeholder-crystal">ğŸ”®</div>
      <div class="placeholder-text">ë²„íŠ¼ì„ ëˆŒëŸ¬ ìš´ì„¸ë¥¼ í™•ì¸í•˜ì„¸ìš”!</div>
    </div>
    <div class="fortune-emoji" id="emoji" style="display:none"></div>
    <div class="fortune-category" id="category"></div>
    <div class="fortune-text" id="fortuneText"></div>
    <div class="fortune-score" id="score">
      <div class="score-label">í–‰ìš´ì§€ìˆ˜</div>
      <div class="score-bar"><div class="score-fill" id="scoreFill"></div></div>
    </div>
  </div>

  <button class="fortune-btn" id="btn" onclick="drawFortune()">âœ¨ ìš´ì„¸ ë½‘ê¸° âœ¨</button>
  <div class="count" id="count">ì˜¤ëŠ˜ ë½‘ì€ íšŸìˆ˜: 0íšŒ</div>
</div>

<script>
// ë³„ ìƒì„±
const starsEl = document.getElementById('stars');
for (let i = 0; i < 80; i++) {
  const star = document.createElement('div');
  star.className = 'star';
  star.style.left = Math.random() * 100 + '%';
  star.style.top = Math.random() * 100 + '%';
  star.style.setProperty('--dur', (1.5 + Math.random() * 3) + 's');
  star.style.animationDelay = Math.random() * 3 + 's';
  starsEl.appendChild(star);
}

const fortunes = [
  { emoji: 'ğŸŒŸ', category: 'ëŒ€ê¸¸ (å¤§å‰)', text: 'ì˜¤ëŠ˜ì€ ëª¨ë“  ì¼ì´ ìˆ ìˆ  í’€ë¦¬ëŠ” ë‚ !\nìì‹ ê°ì„ ê°–ê³  ë„ì „í•˜ë©´ ì¢‹ì€ ê²°ê³¼ê°€!', score: 95 },
  { emoji: 'ğŸ€', category: 'ì¤‘ê¸¸ (ä¸­å‰)', text: 'ì‘ì€ í–‰ìš´ì´ ì°¾ì•„ì˜¤ëŠ” í•˜ë£¨.\nì ì‹¬ ë©”ë‰´ë¥¼ ë°”ê¿”ë³´ë©´ ì¢‹ì€ ì¼ì´!', score: 78 },
  { emoji: 'ğŸ’ª', category: 'ì†Œê¸¸ (å°å‰)', text: 'ë…¸ë ¥í•œ ë§Œí¼ ë³´ìƒì´ ì˜¤ëŠ” ë‚ .\nê³µë¶€ì— ì§‘ì¤‘í•˜ë©´ ì„±ì  UP!', score: 65 },
  { emoji: 'ğŸ˜Š', category: 'ê¸¸ (å‰)', text: 'í‰ë²”í•˜ì§€ë§Œ ì†Œì†Œí•œ ê¸°ì¨ì´ ìˆëŠ” ë‚ .\nì¹œêµ¬ì—ê²Œ ë¨¼ì € ë§ ê±¸ì–´ë³´ì„¸ìš”!', score: 70 },
  { emoji: 'ğŸ”¥', category: 'ëŒ€ë°•ìš´', text: 'ì˜ˆìƒì¹˜ ëª»í•œ ì¢‹ì€ ì†Œì‹ì´!\nê¸‰ì‹ ë©”ë‰´ê°€ ì¢‹ê±°ë‚˜, ìª½ì§€ì‹œí—˜ ì—†ì„ì§€ë„?', score: 88 },
  { emoji: 'ğŸ’•', category: 'ì—°ì• ìš´ UP', text: 'ì„¤ë ˆëŠ” ì¼ì´ ìƒê¸¸ ìˆ˜ë„?!\nìì—°ìŠ¤ëŸ½ê²Œ í–‰ë™í•˜ëŠ” ê²Œ í¬ì¸íŠ¸!', score: 82 },
  { emoji: 'ğŸ“š', category: 'ê³µë¶€ìš´ MAX', text: 'ì§‘ì¤‘ë ¥ì´ ê·¹ëŒ€í™”ë˜ëŠ” ë‚ !\nì˜¤ëŠ˜ ê³µë¶€í•œ ê±´ ë¨¸ë¦¬ì— ì™ì™!', score: 90 },
  { emoji: 'ğŸ®', category: 'íë§ìš´', text: 'ì‰¬ì–´ê°€ëŠ” ê²Œ í•„ìš”í•œ ë‚ .\nì¢‹ì•„í•˜ëŠ” ìŒì•… ë“¤ìœ¼ë©° íë§í•˜ì„¸ìš”!', score: 60 },
  { emoji: 'âš¡', category: 'ë°˜ì „ìš´', text: 'ì²˜ìŒì—” ë³„ë¡œì§€ë§Œ ëì€ ì¢‹ì€ ë‚ !\ní¬ê¸°í•˜ì§€ ë§ê³  ëê¹Œì§€!', score: 73 },
  { emoji: 'ğŸ¯', category: 'ì§‘ì¤‘ìš´', text: 'ëª©í‘œë¥¼ ì •í•˜ë©´ ì´ë£¨ì–´ì§€ëŠ” ë‚ !\ní•˜ê³  ì‹¶ì—ˆë˜ ê±¸ ì‹œì‘í•´ë³´ì„¸ìš”!', score: 85 },
  { emoji: 'ğŸŒˆ', category: 'ì¸ê°„ê´€ê³„ UP', text: 'ìƒˆë¡œìš´ ì¹œêµ¬ë¥¼ ì‚¬ê·ˆ ìˆ˜ ìˆëŠ” ë‚ !\në¯¸ì†Œê°€ ìµœê³ ì˜ ë¬´ê¸°!', score: 80 },
  { emoji: 'ğŸ¦‹', category: 'ë³€í™”ìš´', text: 'ì‘ì€ ë³€í™”ê°€ í° í–‰ìš´ìœ¼ë¡œ!\ní—¤ì–´ìŠ¤íƒ€ì¼ì´ë‚˜ í•„í†µì„ ë°”ê¿”ë³¼ê¹Œ?', score: 72 },
  { emoji: 'ğŸª', category: 'ê¹œì§ìš´', text: 'ì˜ˆìƒ ëª»í•œ ì´ë²¤íŠ¸ ë°œìƒ?!\nì—´ë¦° ë§ˆìŒìœ¼ë¡œ ë°›ì•„ë“¤ì´ë©´ í–‰ìš´!', score: 77 },
  { emoji: 'ğŸ§ ', category: 'ì•„ì´ë””ì–´ í­ë°œ', text: 'ì°½ì˜ë ¥ì´ í„°ì§€ëŠ” ë‚ !\në°œí‘œë‚˜ ê³¼ì œì—ì„œ ë¹›ë‚  ìˆ˜ ìˆì–´ìš”!', score: 86 },
  { emoji: 'ğŸ˜´', category: 'íœ´ì‹ í•„ìš”', text: 'ì—ë„ˆì§€ ì¶©ì „ì´ í•„ìš”í•œ í•˜ë£¨.\nì ê¹ ë‚®ì ì´ ë³´ì•½ì´ ë  ìˆ˜ë„!', score: 50 },
];

let drawCount = 0;
let lastIndex = -1;

function launchConfetti() {
  const container = document.getElementById('confetti');
  const colors = ['#ffd700', '#ff6b6b', '#51cf66', '#74c0fc', '#f783ac', '#ffffff'];
  for (let i = 0; i < 40; i++) {
    const c = document.createElement('div');
    c.className = 'confetti';
    c.style.left = (30 + Math.random() * 40) + '%';
    c.style.top = '40%';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
    c.style.width = (5 + Math.random() * 8) + 'px';
    c.style.height = (5 + Math.random() * 8) + 'px';
    c.style.animation = `confettiFall ${1 + Math.random() * 2}s ease-out ${Math.random() * 0.3}s forwards`;
    container.appendChild(c);
    setTimeout(() => c.remove(), 3000);
  }
}

function drawFortune() {
  const btn = document.getElementById('btn');
  const card = document.getElementById('card');
  const placeholder = document.getElementById('placeholder');
  const emoji = document.getElementById('emoji');
  const category = document.getElementById('category');
  const fortuneText = document.getElementById('fortuneText');
  const scoreFill = document.getElementById('scoreFill');
  const scoreEl = document.getElementById('score');

  // ë¡œë”© ì• ë‹ˆë©”ì´ì…˜
  btn.classList.add('loading');
  card.classList.remove('reveal');
  scoreFill.style.width = '0%';

  // ëœë¤ ì„ íƒ (ì´ì „ê³¼ ë‹¤ë¥¸ ê²ƒ)
  let idx;
  do { idx = Math.floor(Math.random() * fortunes.length); } while (idx === lastIndex);
  lastIndex = idx;
  const f = fortunes[idx];

  setTimeout(() => {
    placeholder.style.display = 'none';
    emoji.style.display = 'block';
    emoji.textContent = f.emoji;
    emoji.className = 'fortune-emoji spin';
    category.textContent = f.category;
    fortuneText.textContent = f.text;
    scoreEl.style.display = 'block';

    card.classList.add('reveal');
    scoreFill.style.width = f.score + '%';

    if (f.score >= 85) launchConfetti();

    btn.classList.remove('loading');
    btn.textContent = 'ğŸ”„ ë‹¤ì‹œ ë½‘ê¸° ğŸ”„';

    drawCount++;
    document.getElementById('count').textContent = `ì˜¤ëŠ˜ ë½‘ì€ íšŸìˆ˜: ${drawCount}íšŒ`;
  }, 600);
}

// Service Worker ë“±ë¡ (PWA)
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').catch(() => {});
}

// ì¢…ë£Œ ê¸°ëŠ¥
function showExitModal() {
  document.getElementById('exitModal').classList.add('show');
}
function hideExitModal() {
  document.getElementById('exitModal').classList.remove('show');
}
function exitApp() {
  // PWA(í™ˆí™”ë©´ ì¶”ê°€)ì—ì„œëŠ” window.close() ì‘ë™
  // ë¸Œë¼ìš°ì €ì—ì„œëŠ” ë¹ˆ í˜ì´ì§€ë¡œ ì´ë™
  window.close();
  setTimeout(() => {
    document.body.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100vh;background:#0f0c29;color:#ffd700;font-family:sans-serif;font-size:1.3rem;text-align:center;padding:20px;">ğŸ”® ì•±ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.<br><br><span style="font-size:0.9rem;color:#aaa;">ì´ íƒ­ì„ ë‹«ì•„ì£¼ì„¸ìš”.</span></div>';
  }, 300);
}
</script>

</body>
</html>
